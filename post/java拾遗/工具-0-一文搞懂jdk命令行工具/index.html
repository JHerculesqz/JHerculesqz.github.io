<!doctype html><html lang=zh-cn itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>【工具】-0-一文搞懂JDK命令行工具 - 妙木山</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes"><meta name=MobileOptimized content="width"><meta name=HandheldFriendly content="true"><meta name=applicable-device content="pc,mobile"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=mobile-web-app-capable content="yes"><meta name=author content="猴王无敌"><meta name=description content="1.工欲善其事：JDK提供的工具 Java试题 JVM调优的常见命令行工具描述正确的有： A.jstat可以实时显示本地或远程JVM进程中类加载、"><meta name=keywords content="Hugo,theme,jane"><meta name=generator content="Hugo 0.74.2"><link rel=canonical href=https://jherculesqz.github.io/post/java%E6%8B%BE%E9%81%97/%E5%B7%A5%E5%85%B7-0-%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82jdk%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/sass/jane.min.b3a8813c06e6d785beba22bf8264e174fa2cb3a396b22f9ba24e2c00c18aaf7f.css integrity="sha256-s6iBPAbm14W+uiK/gmThdPoss6OWsi+bok4sAMGKr38=" media=screen crossorigin=anonymous><meta property="og:title" content="【工具】-0-一文搞懂JDK命令行工具"><meta property="og:description" content="1.工欲善其事：JDK提供的工具 Java试题 JVM调优的常见命令行工具描述正确的有： A.jstat可以实时显示本地或远程JVM进程中类加载、"><meta property="og:type" content="article"><meta property="og:url" content="https://jherculesqz.github.io/post/java%E6%8B%BE%E9%81%97/%E5%B7%A5%E5%85%B7-0-%E4%B8%80%E6%96%87%E6%90%9E%E6%87%82jdk%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/"><meta property="article:published_time" content="2021-08-05T08:10:31+08:00"><meta property="article:modified_time" content="2021-08-05T08:10:31+08:00"><meta itemprop=name content="【工具】-0-一文搞懂JDK命令行工具"><meta itemprop=description content="1.工欲善其事：JDK提供的工具 Java试题 JVM调优的常见命令行工具描述正确的有： A.jstat可以实时显示本地或远程JVM进程中类加载、"><meta itemprop=datePublished content="2021-08-05T08:10:31+08:00"><meta itemprop=dateModified content="2021-08-05T08:10:31+08:00"><meta itemprop=wordCount content="3776"><meta itemprop=keywords content="Java拾遗-JVM,"><meta name=twitter:card content="summary"><meta name=twitter:title content="【工具】-0-一文搞懂JDK命令行工具"><meta name=twitter:description content="1.工欲善其事：JDK提供的工具 Java试题 JVM调优的常见命令行工具描述正确的有： A.jstat可以实时显示本地或远程JVM进程中类加载、"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>妙木山</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><li class=mobile-menu-item><a class=menu-item-link href=https://jherculesqz.github.io/>首页</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://jherculesqz.github.io/categories/>技术专栏</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://jherculesqz.github.io/tags/>Tags</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://jherculesqz.github.io/post/>全部文章</a></li><li class=mobile-menu-item><a class=menu-item-link href=https://jherculesqz.github.io/about/>关于</a></li></ul></nav><link rel=stylesheet href=/lib/photoswipe/photoswipe.min.css><link rel=stylesheet href=/lib/photoswipe/default-skin/default-skin.min.css><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header id=header class="header container"><div class=logo-wrapper><a href=/ class=logo>妙木山</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=https://jherculesqz.github.io/>首页</a></li><li class=menu-item><a class=menu-item-link href=https://jherculesqz.github.io/categories/>技术专栏</a></li><li class=menu-item><a class=menu-item-link href=https://jherculesqz.github.io/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=https://jherculesqz.github.io/post/>全部文章</a></li><li class=menu-item><a class=menu-item-link href=https://jherculesqz.github.io/about/>关于</a></li></ul></nav></header><div id=mobile-panel><main id=main class="main bg-llight"><div class=content-wrapper><div id=content class="content container"><article class="post bg-white"><header class=post-header><h1 class=post-title>【工具】-0-一文搞懂JDK命令行工具</h1><div class=post-meta><time datetime=2021-08-05 class=post-time>2021-08-05</time><div class=post-category><a href=https://jherculesqz.github.io/categories/java%E6%8B%BE%E9%81%97/>Java拾遗</a></div><span class=more-meta>约 3776 字</span>
<span class=more-meta>预计阅读 8 分钟</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>文章目录</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#21主流工具概览>2.1.主流工具概览</a></li><li><a href=#22理解命令行工具的内在逻辑>2.2.理解命令行工具的内在逻辑</a></li><li><a href=#23进阶的方法>2.3.进阶的方法</a></li></ul><ul><li><a href=#31解决什么问题>3.1.解决什么问题</a></li><li><a href=#32参数>3.2.参数</a></li></ul><ul><li><a href=#41解决什么问题>4.1.解决什么问题</a></li><li><a href=#42参数>4.2.参数</a></li></ul><ul><li><a href=#51解决什么问题>5.1.解决什么问题</a></li><li><a href=#52参数>5.2.参数</a></li></ul><ul><li><a href=#61解决什么问题>6.1.解决什么问题</a></li><li><a href=#62参数>6.2.参数</a></li></ul><ul><li><a href=#71解决什么问题>7.1.解决什么问题</a></li><li><a href=#72参数>7.2.参数</a></li></ul></nav></div></div><div class=post-content><h1 id=1工欲善其事jdk提供的工具>1.工欲善其事：JDK提供的工具</h1><ul><li><strong>Java试题</strong></li></ul><blockquote><p>JVM调优的常见命令行工具描述正确的有：</p><p>A.jstat可以实时显示本地或远程JVM进程中类加载、内存、垃圾收集、JIT编译等数据</p><p>B.jmap用于查询当前运行的JVM属性和参数的值</p><p>C.jstack用于生成当前JVM的所有线程快照</p><p>D.jps命令用于查询正在运行的JVM进程</p></blockquote><ul><li><strong>试题解读</strong></li></ul><p>这道题考察JDK自带命令行工具的理解，这些工具用于性能调优、疑难问题定位。</p><p>在生产环境定位时，要求定位/调优工具自身具备极高的性能，否则会对本来就有问题的生产环境产生干扰。</p><p>JDK自带的命令行工具以其的高性能、实用性，成为实战中必须掌握的工具，是Java程序猿的调优武器库。</p><p><img src=images/1.png alt=image-20210521073310456></p><h1 id=2总览>2.总览</h1><h2 id=21主流工具概览>2.1.主流工具概览</h2><p>目前，主流的Java性能监控与调优工具如下图所示：</p><p><img src=images/2.png alt=image-20210521094038209></p><p>这些工具主要分为两个流派：&ldquo;<code>命令行流派</code>"与"<code>可视化流派</code>&rdquo;</p><ul><li>**命令行流派：**强调实用性。体积小、资源消耗小，适用于生产环境的问题定位与调优。</li><li>**可视化流派：**强调颜值即正义。可视化图表、一目了然，适用于开发环境上复现、定位问题。</li></ul><p><img src=images/3.png alt=image-20210521100601641></p><p>这两种流派各有适用的场景，辩证统一，所以还是那句话：&ldquo;成年人不做选择，两样我都要&rdquo;。</p><p><img src=images/4.png alt=image-20210521104216938></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>说明1：本文仅讲解命令行流派的工具，笔者在后续文章中再探讨可视化流派工具。
说明2：不能简单地将Arthas看作工具，后续开专题探讨。
</code></pre></td></tr></table></div></div><h2 id=22理解命令行工具的内在逻辑>2.2.理解命令行工具的内在逻辑</h2><p>对于这些命令行工具，有一种观点：<code>没有必要记下来，用到的时候再查资料</code>。</p><p>因为这些命令行工具比较多，每个命令行也有很多参数，记下来是一件枯燥的事。</p><p>但，这个观点成立有一个前提：我们必须理解这些命令行工具的<code>内在逻辑</code>：</p><ul><li>**逻辑1：**这些命令行工具的关系是什么？</li><li>**逻辑2：**每个工具解决什么问题？</li><li>**逻辑3：**每个工具的参数集合分哪几类？</li></ul><p>如果没有理解上述<code>内在逻辑</code>，需要用的时候再查资料也很难入手。</p><p>对于<code>逻辑1：这些命令行工具的关系</code>，笔者提供一种<code>基于实战问题定位的场景</code>的理解方式：</p><ul><li>**STEP1.进程监控：**首先，找到生产环境中待定位的Java进程。</li><li>**STEP2.配置查询：**进一步，查看此Java进程的JVM配置。</li><li>**STEP3.JVM状态监控与初步分析：**再进一步，查看此Java进程的内存、线程、JIT的整体情况。</li><li><strong>STEP4.内存监控与分析</strong>：如果STEP3发现了可能的内存问题，就深入分析内存。</li><li>**STEP5.线程监控与分析：**如果STEP3发现了可能的线程问题，就深入分析线程。</li></ul><p><img src=images/5.png alt=image-20210521111701312></p><h2 id=23进阶的方法>2.3.进阶的方法</h2><ul><li>**命令行手册：**我们可以通过官方的命令行手册，深入学习它们。</li></ul><p><img src=images/6.png alt=image-20210521112755277></p><ul><li>**工具源码：**通过这些命令行工具的源码，可以更深入地理解JVM状态监控的原理和API。</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>https://hg.openjdk.java.net/jdk/jdk11/file/1ddf9a99e4ad/src/jdk.jcmd/share/classes/sun/tools
</code></pre></td></tr></table></div></div><p><img src=images/7.png alt=image-20210521112939223></p><h1 id=3进程监控-jps>3.进程监控-jps</h1><h2 id=31解决什么问题>3.1.解决什么问题</h2><p>jps用来显示指定系统内所有正在运行的HotSpot虚拟机进程信息。</p><h2 id=32参数>3.2.参数</h2><ul><li>jps的参数格式如下：</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>jps [options] [hostid]
</code></pre></td></tr></table></div></div><p>我们可以通过几个实际的例子，快速理解<code>[options]</code></p><ul><li><p>**例子：**<code>jps</code></p></li><li><p>**例子：**<code>jps -q</code></p></li><li><p>**例子：**<code>jps -lmv</code></p></li></ul><p><img src=images/8.png alt=image-20210521113905035></p><p>我们可以发现，无论怎样的options，一定会显示<code>JVM identifiers</code>，不同的options只是在<code>JVM identifiers</code>的基础上显示更多的额外信息。</p><p>了解到这个程度，实战中如有需要，可以再进一步查看命令行手册：</p><p><code>https://docs.oracle.com/javase/8/docs/technotes/tools/windows/jps.html#CHDCGECD</code></p><p><img src=images/9.png alt=image-20210521114215905></p><h1 id=4配置查询-jinfo>4.配置查询-jinfo</h1><h2 id=41解决什么问题>4.1.解决什么问题</h2><p>jinfo用来查看JVM虚拟机参数，同时可以修改部分JVM虚拟机参数。</p><h2 id=42参数>4.2.参数</h2><ul><li>jinfo的参数格式如下：</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>jinfo [ option ] pid
</code></pre></td></tr></table></div></div><p>我们可以通过几个实际的例子，快速理解<code>[options]</code></p><ul><li>**例子：**<code>jinfo &lt;pid></code>——查看此JVM进程所有的配置</li></ul><p><img src=images/10.png alt=image-20210521115021019></p><ul><li>**例子：**<code>jinfo -sysprops &lt;pid></code>——等价于查看<code>System.getProperties()</code></li></ul><p><img src=images/11.png alt=image-20210521115146579></p><ul><li>**例子：**<code>jinfo -flags &lt;pid></code>——查看所有参数</li></ul><p><img src=images/12.png alt=image-20210521115222055></p><ul><li>**例子：**<code>jinfo -flags &lt;参数名> &lt;pid></code>——查看某个参数的值</li></ul><p><img src=images/13.png alt=image-20210521115244080></p><p>我们可以发现：</p><ul><li>JVM进程的配置分为两类：<code>系统环境变量</code>和<code>JVM参数</code>，jinfo的参数用来输出上述两类配置。</li><li>jinfo支持输出所有的配置值，也可以输出某一个指定参数的值。</li></ul><p>了解到这个程度，实战中如有需要，可以再进一步查看命令行手册：</p><p><code>https://docs.oracle.com/javase/8/docs/technotes/tools/windows/jinfo.html#BCGEBFDD</code></p><p><img src=images/14.png alt=image-20210521115706311></p><h1 id=5jvm状态监控与初步分析-jstat>5.JVM状态监控与初步分析-jstat</h1><h2 id=51解决什么问题>5.1.解决什么问题</h2><p>jstat可以输出JVM的各类状态(类加载、内存、GC、JIT)。</p><p>初步定位的时候，就是通过上述状态，找到诸如内存泄露、线程死锁等问题的蛛丝马迹。</p><h2 id=52参数>5.2.参数</h2><ul><li>jstat的参数格式如下：</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>jstat [ generalOption | outputOptions vmid [ interval[s|ms] [ count ] ]
</code></pre></td></tr></table></div></div><ul><li>**例子：**jstat -class -t -h3 <pid>1000 5——采集类加载信息(每1000ms采样一次，采集5次，每3行打印1次表头)。</li></ul><p><img src=images/15.png alt=image-20210521132054749></p><ul><li>**例子：**jstat -compiler -t -h3 <pid>1000 5——采集JIT信息(每1000ms采样一次，采集5次，每3行打印1次表头)。</li></ul><p><img src=images/16.png alt=image-20210521132151306></p><ul><li>**例子：**jstat -printcompilation -t -h3 <pid>1000 5——采集已经被JIT编译过的方法(每1000ms采样一次，采集5次，每3行打印1次表头)。</li></ul><p><img src=images/17.png alt=image-20210521132611139></p><ul><li><p>**例子：**jstat -gc -t -h3 <pid>1000 5——采集GC的情况(每1000ms采样一次，采集5次，每3行打印1次表头)。</p></li><li><p>**例子：**jstat -gccapacity -t -h3 <pid>1000 5</p></li><li><p>**例子：**jstat -gcutil -t -h3 <pid>1000 5</p></li><li><p>**例子：**jstat -gccause -t -h3 <pid>1000 5</p></li></ul><p><img src=images/18.png alt=image-20210521133656978></p><p>我们可以发现：</p><ul><li><strong>采样相关的参数：</strong>-t(Timestamp列，单位s) 、-h(周期性的增加表头)、interval(采样周期，单位ms)、count(采集次数)</li><li><strong>类加载相关的参数：</strong>-class，显示ClassLoader信息，如：类加载数量、类卸载数量、总空间、类装载消耗的时间。</li><li><strong>JIT相关的参数：</strong>-compiler(显示JIT编译过的方法、耗时)、-printcompilation(输出已经被JIT编译的方法)</li><li>**垃圾回收相关的参数：**gcXxx，例如：-gc：显示GC相关的堆信息。包括Eden、两个Survivor区、老年代、永久代等的容量、已用空间、GC时间合计等信息。</li></ul><p>在此展开看一下垃圾回收相关参数输出的Gc信息，我们可以发现无论哪个gcXxx参数，都会输出如下信息：</p><ul><li>新生代相关</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>S0C：第1个幸存者区的大小(字节)
S1C：第2个幸存者区的大小(字节)
S0U：第1个幸存者区的已使用大小(字节)
S1U：第2个幸存者区的已使用大小(字节)
EC：Eden区的大小(字节)
EU：Eden区的已使用大小(字节)
</code></pre></td></tr></table></div></div><ul><li>老年代相关</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>OC：老年代的大小(字节)
OU：老年代的已使用大小(字节)
</code></pre></td></tr></table></div></div><ul><li>方法区相关</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>MC：方法区的大小
MU：方法区的已使用大小
CCSC：压缩类空间的大小
CCSU：压缩类空间的已使用大小
</code></pre></td></tr></table></div></div><ul><li>GC相关——如果发现两行之间的GC时间占总时间过长或者内存占用不断增加，说明可能有内存问题。</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>YGC：从app启动到采样时，发生的YGC次数
YGCT：从app启动到采样时，发生的YGC的消耗时间(秒)
FGC：从app启动到采样时，发生的FullGC次数
FGTC：从app启动到采样时，发生的FullGC的消耗时间(秒)
GCT：从app启动到采样时，发生的GC的总时间(秒)
</code></pre></td></tr></table></div></div><p><img src=images/19.png alt=image-20210521133405766></p><p>了解到这个程度，实战中如有需要，可以再进一步查看命令行手册：</p><p><code>https://docs.oracle.com/javase/8/docs/technotes/tools/windows/jstat.html#BEHHGFAE</code></p><p><img src=images/20.png alt=image-20210521131317493></p><h1 id=6内存监控与分析-jmapjhat>6.内存监控与分析-jmap/jhat</h1><h2 id=61解决什么问题>6.1.解决什么问题</h2><ul><li>jmap可以将内存信息导出为dump文件(也叫做堆转储快照文件)。<ul><li>当用jstat初步定位发现疑似内存泄露时，就可以通过jmap将内存快照导出出来，进一步定位。</li></ul></li><li>jhat可以导入jmap导出的内存快照文件，进行相对可视化的查看。<ul><li>jhat内置了一个微型的http服务器，用于查看dump文件的分析结果。</li><li>JDK11已经删除了jhat，官方推荐用VisualVM替代。</li></ul></li></ul><h2 id=62参数>6.2.参数</h2><ul><li>jmap的参数格式如下：</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>jmap [option] &lt;pid&gt;
</code></pre></td></tr></table></div></div><ul><li>**例子：**jmap -dump:format=b,file=&lt;filepath.hprof> <pid>——手动导出某个时间点的内存快照，会触发1次FullGC，dump文件中会保存FullGC后留下的对象信息，对于大内存镜像会比较耗时。</li><li>**例子：**java -jar xxx.jar -Xmx100m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=&lt;filepath.hprof>——当待定位的系统发生OOM的时候出现闪退时，此时会自动导出dump文件。</li></ul><p>当然，如何分析dump文件是一个更大的话题，后续再展开。仅针对jmap命令行了解到这个程度，实战中如有需要，可以再进一步查看命令行手册：</p><p><code>https://docs.oracle.com/javase/8/docs/technotes/tools/windows/jmap.html#CEGCECJB</code></p><p><img src=images/21.png alt=image-20210521135354519></p><h1 id=7线程监控与分析-jstack>7.线程监控与分析-jstack</h1><h2 id=71解决什么问题>7.1.解决什么问题</h2><p>jstack可以生成虚拟机指定进程当前时刻的线程快照，用于定位线程长时间停顿的原因。</p><h2 id=72参数>7.2.参数</h2><ul><li>jstack的参数格式如下：</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>jstack &lt;pid&gt;
</code></pre></td></tr></table></div></div><ul><li>**例子：**jstack <pid>——如果程序中有线程死锁，会在dump文件中体现出来。</li></ul><p><img src=images/22.png alt=image-20210521140136121></p><p>了解到这个程度，实战中如有需要，可以再进一步查看命令行手册：</p><p><code>https://docs.oracle.com/javase/8/docs/technotes/tools/windows/jstack.html#BABGJDIF</code></p><p><img src=images/23.png alt=image-20210521135529140></p><h1 id=8总结>8.总结</h1><p>本文主要内容：</p><ul><li>JVM性能监控与调优的工具有两种流派：命令行工具、可视化工具。</li><li>学习命令行工具集的内在逻辑：工具间的关系、每个工具解决的问题、每个工具的参数分类。</li><li>进程监控工具：jps</li><li>配置查询工具：jinfo</li><li>JVM状态监控工具：jstat</li><li>内存监控与分析工具：jmap、jhat(jdk11用VisualVM替代)</li><li>线程监控与分析工具：jstack</li></ul><h1 id=9参考文献>9.参考文献</h1><blockquote><p><a href=https://docs.oracle.com/javase/8/docs/technotes/tools/windows/>https://docs.oracle.com/javase/8/docs/technotes/tools/windows/</a></p></blockquote></div><div class=post-copyright><p class=copyright-item><span class=item-title>文章作者</span>
<span class=item-content>猴王无敌</span></p><p class=copyright-item><span class=item-title>上次更新</span>
<span class=item-content>2021-08-05</span></p><p class=copyright-item><span class=item-title>许可协议</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>赞赏支持</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=/weixin.png>
<span>微信打赏</span></label>
<label class=qr-code-image for=reward><img class=image src=/alipay.png>
<span>支付宝打赏</span></label></div></div><footer class=post-footer><div class=post-tags><a href=https://jherculesqz.github.io/tags/java%E6%8B%BE%E9%81%97-jvm/>Java拾遗-JVM</a></div><nav class=post-nav><a class=prev href=/post/java%E6%8B%BE%E9%81%97/%E7%BC%96%E8%AF%91%E5%BC%95%E6%93%8E-2-%E5%AD%A6%E4%B9%A0%E9%98%85%E8%AF%BBclass%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%8416%E8%BF%9B%E5%88%B6%E7%89%88-%E4%B8%AD/><i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417l277.93508-310.326815c11.338233-12.190647 11.035334-32.285311-.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"/></svg></i><span class="prev-text nav-default">【编译引擎】-2-学习阅读Class文件结构(16进制版)-中</span>
<span class="prev-text nav-mobile">上一篇</span></a>
<a class=next href=/post/java%E6%8B%BE%E9%81%97/%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E-0-%E9%9A%8F%E6%9C%BA%E5%BA%94%E5%8F%98+%E6%9C%89%E5%A4%87%E8%80%8C%E6%9D%A5/><span class="next-text nav-default">【执行引擎】-0-随机应变+有备而来</span>
<span class="prev-text nav-mobile">下一篇</span>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"/></svg></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=icon-links><a href=mailto:JHercules_qz@qq.com rel="me noopener" class=iconfont title=email><svg class="icon" viewBox="0 0 1451 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408 1361.641813S1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523L83.726336 1024H682.532949 753.579947 1348.948139L1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955C777.248 802.205449 742.347691 811.03081 718.063616 811.603883z"/></svg></a><a href=https://github.com/JHerculesqz rel="me noopener" class=iconfont title=github target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M512 12.672c-282.88.0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667.0-12.16-.426667-44.373333-.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333.0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333.0.0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667.0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72.0 68.522667-.64 123.562667-.64 140.202666.0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"/></svg></a><a href=https://jherculesqz.github.io/index.xml rel="noopener alternate" type=application/rss+xml class=iconfont title=rss target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><path d="M819.157333 1024C819.157333 574.592 449.408 204.8.0 204.8V0c561.706667.0 1024 462.293333 1024 1024H819.157333zM140.416 743.04a140.8 140.8.0 01140.501333 140.586667A140.928 140.928.0 01140.074667 1024C62.72 1024 0 961.109333.0 883.626667S62.933333 743.082667 140.416 743.04zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352.0 678.784 306.517333 678.784 678.826667z"/></svg></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme - <a class=theme-link href=https://github.com/xianmin/hugo-theme-jane>Jane</a></span>
<span class=copyright-year>&copy;
2021
<span class=heart><i class=iconfont><svg class="icon" viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14"><path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7.0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1.0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2.0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3.1-42.5-8-83.6-24-122.2z" fill="#8a8a8a"/></svg></i></span><span class=author>猴王无敌</span></span></div></footer><div class=back-to-top id=back-to-top><i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="35" height="35"><path d="M510.866688 227.694839 95.449397 629.218702h235.761562L329.15309 958.01517h362.40389L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777h894.052392v131.813095H63.840492V63.962777zm0 0"/></svg></i></div></div><script type=text/javascript src=/lib/jquery/jquery-3.2.1.min.js></script><script type=text/javascript src=/lib/slideout/slideout-1.0.1.min.js></script><script type=text/javascript src=/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin=anonymous></script><script type=text/javascript src=/js/load-photoswipe.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe.min.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe-ui-default.min.js></script></body></html>